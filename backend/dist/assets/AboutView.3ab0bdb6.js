import{d as S,r as p,o as d,c as u,a as t,w,v as $,u as g,i as I,F as x,b as T,e as U,n as B,t as M,p as R,f as O,_ as D,g as j,h as b,j as q,k as C,l as E}from"./index.aafed89b.js";const F=i=>(R("data-v-f93ff9d4"),i=i(),O(),i),P=F(()=>t("div",{style:{width:"100%",height:"fit-content",margin:"1rem auto","text-align":"center"}},[t("h2",null,"Mail Blaster")],-1)),H={class:"form-group row"},L={class:"col-12"},A=F(()=>t("div",{style:{width:"100%",height:"fit-content",margin:"1rem auto","text-align":"center"},class:"form-group row"},[t("div",{class:"col-12"},[t("h4",null,"Mail Preview")])],-1)),J={class:"form-group row"},z={class:"col-12"},G={class:"panel panel-primary",id:"result_panel"},K=F(()=>t("div",{class:"panel-heading"},[t("h3",{class:"panel-title"},"Result List")],-1)),Q={class:"panel-body"},W={key:0,class:"list-group"},X=S({__name:"EmailForm",setup(i){const c=`Hi {{Contact Name}} 
`;let l=p(""),r=p(`${c}`),_=p([]);async function v(){const n=new Headers;n.append("Content-Type","application/x-www-form-urlencoded");const o=new URLSearchParams;o.append("content",JSON.stringify(l)),fetch("http://localhost:8080/mail",{method:"POST",headers:n,body:o,responseType:"stream"}).then(a=>{if(a.body){const s=a.body.getReader();return new ReadableStream({start(h){return y();function y(){return s.read().then(({done:f,value:V})=>{if(f){h.close();return}return h.enqueue(V),y()})}}})}}).then(a=>new Response(a)).then(a=>a.blob()).then(a=>a.text()).then(a=>{const s=a.match(/{([^}]+)}/g),h=s||[];h.length>0&&h.map(f=>JSON.parse(f)).forEach(f=>{_.value.push(f)})}).catch(a=>console.error(a))}function m(n){r.value=c+n.target.value}return(n,o)=>(d(),u(x,null,[P,t("form",null,[t("div",H,[t("div",L,[w(t("textarea",{id:"email-content",onKeyup:o[0]||(o[0]=e=>m(e)),"onUpdate:modelValue":o[1]||(o[1]=e=>I(l)?l.value=e:l=e),name:"email-content",cols:"25",rows:"5",class:"form-control",required:"true"},`
        `,544),[[$,g(l)]])])]),A,t("div",J,[t("div",z,[w(t("textarea",{disabled:"","onUpdate:modelValue":o[2]||(o[2]=e=>I(r)?r.value=e:r=e),name:"email-preview",cols:"25",rows:"5",class:"form-control"},`
        `,512),[[$,g(r)]])])]),t("div",{class:"form-group row"},[t("div",{class:"offset-4 col-8"},[t("button",{name:"submit",type:"button",onClick:v,class:"btn btn-primary"}," Send ")])])]),t("div",G,[K,t("div",Q,[g(_).length>0?(d(),u("ul",W,[(d(!0),u(x,null,T(g(_).values(),(e,a)=>(d(),u("li",{class:B(["error-list list-group-item",{"success-list":e.status}]),key:a},M(e.message),3))),128))])):U("",!0)])])],64))}});const Y=D(X,[["__scopeId","data-v-f93ff9d4"]]),Z={id:"infinite-table",class:"table-responsive"},tt={class:"table table-sm table-bordered table-hover"},et=t("th",null,"Email Address",-1),ot=t("th",null,"Contact Name",-1),nt=t("i",{class:"fa fa-plus"},null,-1),at=[nt],st={scope:"row"},ct=["onUpdate:modelValue","onFocusout","onFocusin"],lt=["onUpdate:modelValue","onFocusout","onFocusin"],it=["onClick"],rt=t("i",{class:"fa fa-trash"},null,-1),dt=[rt],ut=S({__name:"DataTable",setup(i){const c=p([]);let l={};async function r(n,o){const e={method:"delete",url:`http://localhost:8080/contact/${n}`,headers:{},data:""};(await b(e)).data?c.value.splice(o,1):console.error("Unable to delete")}async function _(n,o){if(n!==l[o]){const e=o==="contact_email"?"changeEmail":"changeName",a={method:"patch",url:`http://localhost:8080/contact/${l.contact_email}?${e}=${n}`,headers:{},data:""};await b(a)}}async function v(){const n={contact_name:"New Item",contact_email:"New Item"};let o=c.value.length>0?c.value[0]:{};if(o.contact_name!==n.contact_name||o.contact_email!==n.contact_email){c.value.unshift({contact_name:"New Item",contact_email:"New Item"}),o=n;const e={method:"put",url:`http://localhost:8080/contact/${o.contact_email}/${o.contact_name}`,headers:{},data:""};await b(e)}}function m(n){l={contact_name:n.contact_name,contact_email:n.contact_email}}return j(()=>{b({method:"get",url:"http://localhost:8080/contact",headers:{}}).then(function(o){c.value=o.data.contacts}).catch(function(o){console.log(o)})}),(n,o)=>(d(),u("div",Z,[t("table",tt,[t("thead",null,[t("tr",null,[et,ot,t("th",null,[t("button",{onClick:o[0]||(o[0]=e=>v()),class:"btn"},at)])])]),t("tbody",null,[(d(!0),u(x,null,T(c.value.values(),(e,a)=>(d(),u("tr",{key:a},[t("th",st,[w(t("input",{class:"noBordersInput","onUpdate:modelValue":s=>e.contact_email=s,onFocusout:s=>_(e.contact_email,"contact_email"),onFocusin:s=>m(e)},null,40,ct),[[$,e.contact_email]])]),t("td",null,[w(t("input",{class:"noBordersInput","onUpdate:modelValue":s=>e.contact_name=s,onFocusout:s=>_(e.contact_name,"contact_name"),onFocusin:s=>m(e)},null,40,lt),[[$,e.contact_name]])]),t("td",null,[t("button",{onClick:s=>r(e.contact_email,a),class:"btn"},dt,8,it)])]))),128))])])]))}});const _t={components:{EmailForm:Y,DataTable:ut}};let N=p([]),k=p(!1);q(async()=>{k.value=!0;const i=await fetch("https://jsonplaceholder.typicode.com/users");N.value=await i.json(),console.log(N.value),k.value=!1});const mt={style:{width:"100%",height:"100%"}},pt={class:"container-fluid"},ht={class:"row gx-4 justify-content-center"},ft={class:"col-md-6"},vt={class:"col-md-6"};function gt(i,c,l,r,_,v){const m=C("DataTable"),n=C("EmailForm");return d(),u("main",mt,[t("div",pt,[t("div",ht,[t("div",ft,[E(m)]),t("div",vt,[E(n)])])])])}const wt=D(_t,[["render",gt]]);export{wt as default};
